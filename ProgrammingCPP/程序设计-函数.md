# 程序设计之进阶-函数

## 1、函数的概念
函数的概念与数学函数定义一致。

y = f(x)
如果x每个确定的值与y都有唯一确定的值与之对应。那么x和y就是函数关系，x是自变量y是因变量。

## 2、cpp分类
- 系统预置函数
- 自定义函数

## 3、cpp函数声明定义
### 3.1、声明定义范式：

	返回值数据类型 函数名(参数类型约束 参数变量名, ......){
		函数体，代码块;
	}
	
### 3.2、定义函数的位置

如果是在main函数定义函数，就需要定义在main函数和预定义之间自定义函数。

如果在main函数的下面自定义函数，那么需要在main函数和预定义之间先声明一下这个函数`返回值数据类型 函数名(参数类型约束, ......);`，这样函数才能起作用。是因为编译器是之上而下编译的，如果编译到main中调用了main下面的函数那么编译器是不知道这个函数是什么，所以编译失败。

返回值数据类型 函数名(参数类型约束列表);没有函数体没有参数名的函数是`函数的原型`也可以称之为`形式函数`。

获取了函数的原型就可以知道如何调用这个函数了，但是不知道函数具体做了什么。函数的原型又称之为函数的“Signature”，在软件工程中称为函数的基调。

## 4、函数的组成部分
1、返回值数据类型：函数定义之初约定的返回值的数据类型。如果定义了返回值数据类型那么函数体中必须返回约定的类型数据，即使没有处理结果也要返回。比如main函数中的`return 0;`
2、函数名：函数名称的标示。
3、参数列表：传入的参数必须符合参数的类型约束的指定的数据类型，否则系统无法执行该函数。函数参数列表可以为空。
4、函数体，代码块：函数体是函数的功能性代码主体，但是函数体最好是以`return;`为结尾，如果函数没有返回值也可以没有return语句。
5，返回值，函数的返回值数据类型定义成`void`的函数是可以没有返回值，也就是函数体可以不使用return语句返回数据。如果函数体定义了返回值，接收到的函数返回值的数据类型就是函数定义的返回数据类型。

### 4.1、参数的引用
定义的参数名，在函数体中可以引用参数列表中的参数名作为变量名来使用。

### 4.2、参数的特点：
因为参数是个可变量所以适用变量规则。

### 4.3、参数的分类：
形式参数简称形参：函数在定义代码中定义的参数名变量是形式参数简称形参。
实际参数简称实参：函数在被调用的代码中给函数传递的参数变量名和传递的值是实际参数简称实参。

## 5、函数调用

函数调用：

	变量 = 函数名(参数);  

大部分函数是有返回值的，可以设置一个变量接收函数的返回值也可以不接收函数的返回值。设置的接收函数的返回值的变量要与函数的返回值数据类型的数据类型一致。

根据函数的在程序中出现的位置和形式来分，调用分3种：

1、独立语句：`function_name(params);`
2、作为表达式的部分：`value = function_name(params)  + values;`
3、实参形式出现在其他函数调用用：`value = function_name(function_name(params));`


### 5.1、Example应用

```c++
//自定义函数
int addOneByNumber(int a)
{
	return ++a;
}

//主函数
int main()
{
	//定义一个符合函数返回值数据类型的变量
	int a;
	//调用函数
	a = addOneByNumber(1);
	//输出结果是2
	cout << a;
}

```


### 5.2、函数类型
函数也是有类型的。函数的类型是指函数的返回值的数据类型。比如说一个函数定义了返回的数据类型是int型，那么这个函数也是int函数。

## 6、系统函数
### 6.1、main函数
main函数是c/cpp程序的主函数，程序入口函数。
main函数的格式：
int main(){return 0;}还有一种是void main(){}，这两种都是可以使用的，void main(){}这种是老版本的，调用main函数的程序无法获取main函数的执行结果，推荐使用int main(){return 0;}这个格式的main函数。这里的return 0;是符合main函数的返回值类型的约定同时返回0也有程序停止的意思。

### 6.2、文件的引用
cpp中使用 include 引用文件，引用的文件名用"文件名"双引号，而系统类库是<系统类库>尖括号。这是因为引用的名称是双引号编译器会优先查找自定义函数库，而尖括号编译器会优先查找系统函数库。

## 7、函数的执行

### 7.1、函数的执行过程和执行原理

```c++
//main是主函数
//function_name是被调用函数
//type是类型约束
//param是参数
//value是值
int main ()
{
	type param = value;
	res = function_name(type param);
}
```

1、main函数是程序的程序入口，同时main也是一个函数，程序会先在内存中开辟出一个栈区也可以理解成一个连续的内存空间的映射的一个地址（内存逻辑地址不是内存的物理地址）把main函数加载到这个栈区中。
2、程序继续执行然后执行到main函数中有调用函数的语句，然后在内存中开辟出新栈区，将调用的函数加载到栈区中。
3、然后main函数的程序停止执行，同时记录下当前的main函数的现场。
4、给被调用函数的实参是在main函数栈区中的变量对应的内存存储的值，将调用函数的实参复制一份实参的**值（内存的数据）**给被调用函数栈区内形参空间当中。
5、执行被调用函数，然后返回值。同时会释放被调用函数的内存栈区。
6、main接收到被调用函数的返回值，恢复现场继续向下执行。

### 7.2、小结
1、如果传递的是值，被调用函数内的形参值的任何处理都不会影响到调用该函数的实参变量，因为实参和形参完全不在同一个内存栈区都是在自己函数的作用域内，所以不会互相影响。如果传递的实参变量的内存地址那么就会有影响。
example：

```c++
#include <iostream>
using namespace std;
//预定义部分结束

//声明函数
void changeParam(int);

//主函数
int main()
{
    int change_param = 10;
    cout << change_param << endl; //10
    changeParam(change_param);
    cout << change_param << endl; //10 因为main函数的change_param变量和changeParam函数的change_param变量分别在各自的内存栈区中，所以互不干扰。
    return 0;
}

//自定义函数
void changeParam(int change_param)
{
    change_param++;
}
```

2、这也就是为什么实参和形参的数据类型必须保持一致或者兼容，因为新开辟出的栈区内参数存储单元和传递的参数值对应的数据类型要求的存储单元格式必须相同。
3、变量是内存栈区的连续存储空间的映射的逻辑地址。函数内的变量的内存空间是在函数的内存栈区内，所以这个变量只能作用于该函数的内存栈区中。


## 8、变量的作用域
变量的作用域就是变量的作用范围。
### 8.1、依据作用域可以分为
局部变量：在函数体内或代码块内定义并且只在函数或代码块内起作用的变量。PS：代码块是用{}内的代码合集。
全局变量：在函数体外或代码块外定义并且在整个程序文件内起作用的变量。全局和局部都是相对的。
特殊情况：局部变量名与全局变量名相同时，局部变量将在自己作用域内有效同时临时屏蔽全局变量。全局变量与局部变量之间的关系。

### 8.2、Example

```c++
#include <iostream>
using namespace std;

//变量的作用域example

//全局变量
int global_value = 10;

//声明函数
void changeVule(int);
void test_global_value(int);

//主函数
int main()
{
    cout << global_value << endl; //10
    //局部变量
    int score = 11;
    changeVule(score);
    cout << global_value << endl; //20
    test_global_value(1);
    cout << global_value << endl; //20
    return 0;
}

//定义函数
void changeVule(int score)
{
    //形参score也是局部变量
    if (score > 10) {
        global_value += 10;
    }
    return;
}

//定义函数
void test_global_value(int global_value)
{
    //这里的局部变量与全局变量重名，这里局部变量将屏蔽全局变量
    global_value -= 10;
    return;
}
```

### 8.3、小结
用内存栈区概论去理解变量作用域会理解比较深刻。

### 8.4、Q&A
全局变量作用域是这个代码整个文件内还是整个程序流程内？
函数体内或代码块内的程序语句使用和访问全局变量的底层原理？是地址连接？

## 9、数组与函数
在函数调用中数组的元素作为实参与变量作为实参的效果是等价的。因为是复制一份值给形参的。

	函数名(数组名[下标]);

在函数调用中数组名作为实参传递调用函数，那么传递就是这个数组名所指向存储数组的内容空间区域的地址。也就是传递的是数组的内存地址，所以在被调用函数内形参数组所接收到的值是实参的地址，所有被调用函数内的任何操作都会影响到调用被调用函数作用域的数组内的数据。

	函数名(数组名);
	
数组名不是变量是常量，是数组在内存中的地址。

### 9.1、Examp

```c++
#include <iostream>
using namespace std;

/**
 * @brief 
 * 
 * @param a 
 * @param b 
 */
void change1(int a, int b)
{
    a = 10;
    b = 20;
    return;
}

/**
 * @brief 
 * 
 * @param a //a是数组名，a是数组在内存中的地址
 */
void change2(int a[])
{
    //这里形参a接收到的是数组的地址
    a[0] = 10;
    a[1] = 20;
    return;
}

/**
 * 主函数
 * @brief 
 * 
 * @return int 
 */
int main()
{
    int a[] = {1, 2};
    cout << a[0] << ";" << a[1] << endl; //1;2
    change1(a[0], a[1]);
    cout << a[0] << ";" << a[1] << endl; //1;2
    change2(a);
    cout << a[0] << ";" << a[1] << endl; //10;20
    return 0;
}
```

## 10、函数拓展

函数是可以有多个返回值
函数可以返回括号表达式：

	return (表达式1, 表达式2, 表达式3);

在返回之前先运算表达式然后再返回，运算的顺序是：表达式1 -> 表达式2 -> 表达式3。从左向右，赋值运算是右侧赋给左侧，其余的场景都是从左向右运算的顺序。如果有括号表达式会优先运算括号表达式，然后遵循运算优先级进行运算。
